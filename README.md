# Kuban-online
Сервис для проверки расписания врача на сайте [kuban-online.ru](https://kuban-online.ru/). Когда статус меняется, то в
телеграм отправляется об этом уведомление. 

Выполните команду `php application doctor:ckeck <id>` чтобы узнать статус врача с идентификатором id. Можно добавить эту
команду к cron, например на каждые 5 минут. И тогда, когда статус врача изменится, в телеграм придет уведомление.

## Установка
1. Клонируете себе репозиторий 
`git clone git@github.com:shahruslan/kuban-online.git`

2. Потягиваем зависимости `composer i`

3. Создаем .env файл
`cp .env.example .env`
   
4. Параметры `CLINIC_ID` и `PATIENT_ID` смотрим во вкладке network на странице https://kuban-online.ru/signup/free/

5. Создаем нового бота. [@BotFather](https://t.me/BotFather) и выписываем token_api и bot_name. Получить id своего 
   аккаунта telegram можно с помощью этого [бота](https://t.me/userinfobot)

6. Параметр `CACHE_TIME` влияет на повторную отправку уведомления о статусе, если он еще не поменялся. Например, 
   если значение указано 3600, бот каждый час будет присылать уведомление о статусе, не зависимо от того, изменился
   статус или нет.
   
7. В файле `config.php` указываются параметры проверки статуса. Массив `days` указывает в какие дни недели нужно
   отправлять запросы на проверку. Ключ `time` указывает в какие промежутки времени делать запросы. Промежутки времени
   указываются в часах. А массив `doctors` нужен для подсказки в уведомлении, о каком докторе идет речь.
   
8. Добавляем в крон задачу `*/10 * * * * php application doctor:ckeck <id>`. 